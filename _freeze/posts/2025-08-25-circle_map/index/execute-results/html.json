{
  "hash": "51df787176a350465adef0f452d31ec2",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Circle Tree map\"\ndescription: \"Which groups share the most common ground? A circular treemap\"\nimage: circle_tree_map.png\ncategories: [R, Python]\nbibliography: ../../references.bib\n  \nformat:\n  live-html:\n    toc: true\n    resources:\n      - data\nengine: knitr\nwebr:\n  packages:\n    - dplyr\n    - ggplot2\n    - data.tree\n    - downloadthis\n    - slopes\npyodide:\n  packages:\n    - pandas\n    - anytree\n---\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n```{=html}\n<style>\n.exercise-editor-btn-run-code {\n  color: #179498 !important; /* override Bootstrap if necessary */\n  border-color: #179498 !important;\n  background-color: white !important; /* if you want to change bg */\n}\n\n.exercise-editor-btn-run-code:hover {\n  background-color: #179498 !important;\n  color: white !important;\n}\n</style>\n```\n\n\n\n\nThis quick fix is a small data science project that builds a circle tree map using R, while the data wrangling, including impot, tidy and transform, are in Python and R. A circle tree map is a plot that represents hierarchically structured data with the root at the top and the tree unfolding beneath with parent pointing to its children [@Nguyen2005]. An example of a circle tree map is the [body of knowledge of GIS](https://bok.eo4geo.eu/GIST) by SpaceSUITE.\n\n![](example_circular_tree_map.png){.lightbox}\n\nIn this case, the reason to write the post was to share this idea with C., who currently works for [EKSH](https://www.eksh.org/). As he landed to the company, C needed to visualize what were the main focus areas or research fields to better understand the company, find common interest between their colleagues or to find out which area receives greatest attention.\n\n> What insights about balance and distribution can a circular treemap uncover in hierarchical data?\n\nFor educational purposes, the data of this post are courses I have completed. Therefore, the purpose is to see the balance and distribution of the courses structured in four main childrens, Geographical Information System (GIS), Environmental Sciences (ENV), Languages(LNG) and Biology & Geology (B&G).\n\n# Import\n\n::: {.panel-tabset group=\"language\"}\n\n# R\n\n\n\n\n::: {.cell}\n```{webr}\n#| label: import-data-r\n# See where we are in the file system:\ndata <- read.csv(\"data/cv_certificates.csv\", encoding=\"latin3\")\nstr(data)\n```\n:::\n\n\n\n\n# Python\n\n\n\n\n::: {.cell}\n```{pyodide}\n#| label: import-data-py\nimport pandas as pd\ndata = pd.read_csv('data/cv_certificates.csv', encoding='latin1')\ndata.info()\n```\n:::\n\n\n\n\n:::\n\n# Tidy\n\n# Transform\n\n:::{.panel-tabset group=\"language\"}\n\n# R\n\n\n\n\n::: {.cell}\n```{webr}\n#| label: transform-node-r\n# Create hierarchy\ndata$pathString <- paste(\"world\", data$group, data$id, sep = \"/\")\nlibrary(data.tree)\npopulation <- as.Node(data)\npopulation\n```\n:::\n\n\n\n\n# Python\n\n\n\n\n::: {.cell}\n```{pyodide}\ndata['pathString'] = 'world/' + data['group']+ data['id'].astype(str)\ndata['pathString']\n```\n:::\n\n\n\n\n\n:::\n# Visualize\n\nhttps://python-graph-gallery.com/circular-packing-several-levels-of-hierarchy/\n\nThe package [circlepackeR](https://jeromefroe.github.io/circlepackeR/) available in R used the nodes and link obtained from the transformation step to a circular tree map. \n\n\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(circlepackeR)\ncircle_certificates <- circlepackeR(\n  population,\n  size = \"value\",\n  width = \"100%\",    # Critical: do NOT use numeric width\n  height = 400,      # You can adjust this height\n  color_min = \"hsl(171, 60%, 66%)\",\n  color_max = \"hsl(231, 75%, 11%)\"\n)\ncircle_certificates\n```\n\n::: {#fig-circle-certificates .cell-output-display}\n\n```{=html}\n<div id=\"htmlwidget-040cc859fa4eb0433afb\" style=\"width:100%;height:400px;\" class=\"circlepackeR html-widget\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-040cc859fa4eb0433afb\">{\"x\":{\"data\":{\"name\":\"world\",\"children\":[{\"name\":\"ENV\",\"children\":[{\"name\":\"1\",\"description\":\"CURSO SEGURIDAD Y SALUD EN EL TRABAJO. ISO 45001:2018.\",\"group\":\"ENV\",\"id\":1,\"link\":\"https://drive.google.com/file/d/1YhHZgCTsFxKhkYgwnAL9y76pGGktTeCL/view?usp=sharing\",\"value\":50},{\"name\":\"2\",\"description\":\"II EDICIÓN CURSO SISTEMAS DE GESTIÓN INTEGRADA. CALIDAD Y MEDIO AMBIENTE\",\"group\":\"ENV\",\"id\":2,\"link\":\"https://drive.google.com/file/d/1uIpLHoSeg9DV86umbFE4_QxcBc80PywJ/view?usp=sharing\",\"value\":150},{\"name\":\"5\",\"description\":\"SBN e infraestructuras verdes en entornos urbanos mediterráneos\",\"group\":\"ENV\",\"id\":5,\"link\":\"https://drive.google.com/file/d/1mbtMe-iEqBLmhQvKrivQElovgiPBtabm/view?usp=sharing\",\"value\":25},{\"name\":\"7\",\"description\":\"Reducción de emisiones y Huella de Carbono para empresas\",\"group\":\"ENV\",\"id\":7,\"link\":\"https://drive.google.com/file/d/1Jja7MKalbzv38GONnyGspUDltzKqwNUg/view?usp=sharing\",\"value\":60},{\"name\":\"12\",\"description\":\"Cálculo de Huella de Carbono\",\"group\":\"ENV\",\"id\":12,\"link\":\"https://drive.google.com/file/d/1jynbDBbRw7o7rUmt0sSBk3Lp5dOgHrUY/view?usp=sharing\",\"value\":120},{\"name\":\"14\",\"description\":\"Simposio SIAGA\",\"group\":\"ENV\",\"id\":14,\"link\":\"https://drive.google.com/file/d/1n-kxKxpjfbOFoVzhEzTmXmiO3IzjWCCe/view?usp=sharing\",\"value\":30},{\"name\":\"15\",\"description\":\"Gestión de Especies Invasoras Marinas: Construyendo una Propuesta para Andalucía\",\"group\":\"ENV\",\"id\":15,\"link\":\"https://drive.google.com/file/d/1yAqN8ufo3mi0FVppNbOSxXYrhl1CxEUk/view?usp=sharing\",\"value\":15},{\"name\":\"16\",\"description\":\"Diversidad Biológica, Conservación Y Cooperación Internacional hacia la sostenibilidad del archipiélago de Galápagos\",\"group\":\"ENV\",\"id\":16,\"link\":\"https://drive.google.com/file/d/13NSPEP_u6epUkHPG84Mi3rscV839cDQM/view?usp=sharing\",\"value\":50},{\"name\":\"17\",\"description\":\"El clima que viene y su impacto en el medio ambiente en España\",\"group\":\"ENV\",\"id\":17,\"link\":\"https://drive.google.com/file/d/1BX4g2ffmK76utuKeNZ1zFj04Vy4nQmDW/view?usp=sharing\",\"value\":20},{\"name\":\"18\",\"description\":\"Valores naturales de la provincia de Málaga\",\"group\":\"ENV\",\"id\":18,\"link\":\"https://drive.google.com/file/d/1Qa4lvlGv_dDOhZ3OBLYEuqYiiZeGw-XH/view?usp=sharing\",\"value\":20}]},{\"name\":\"LNG\",\"children\":[{\"name\":\"3\",\"description\":\"INGLÉS C1\",\"group\":\"LNG\",\"id\":3,\"link\":\"https://drive.google.com/file/d/1pTQYdbcloZMeZMnWu7w8v26oZ9P-m7b-/view?usp=sharing\",\"value\":240},{\"name\":\"4\",\"description\":\"Curso de Inmersión en Lengua Inglesa - Profesorado (C1)\",\"group\":\"LNG\",\"id\":4,\"link\":\"https://drive.google.com/file/d/1ozr5WpdXleWMxNQP5S5aFR3AKa8TOK9O/view?usp=sharing\",\"value\":40},{\"name\":\"6\",\"description\":\"Curso de Inmersión en Lengua Inglesa C1\",\"group\":\"LNG\",\"id\":6,\"link\":\"https://drive.google.com/file/d/1Ekqyw2bpMdhJtKoQOJxBDlK6MSzGCG6i/view?usp=sharing\",\"value\":43}]},{\"name\":\"GIS\",\"children\":[{\"name\":\"8\",\"description\":\"Iniciación al Análisis Estadístico en Investigación Científica con Rstudio\",\"group\":\"GIS\",\"id\":8,\"link\":\"https://drive.google.com/file/d/1CEbxFrce50PMg8CY8tNHatrdxzIPkRqu/view?usp=sharing\",\"value\":100},{\"name\":\"10\",\"description\":\"Teledetección para la humedad del suelo: Fuentes, Procesamiento y Asimilación de Datos para el Modelado Hidrológico\",\"group\":\"GIS\",\"id\":10,\"link\":\"https://drive.google.com/file/d/1-vFDK0xpkkvcFoYQC19s7QSCoTvz1Upk/view?usp=sharing\",\"value\":33},{\"name\":\"11\",\"description\":\"Introducción al Manejo y Análisis de Datos Ambientales en R\",\"group\":\"GIS\",\"id\":11,\"link\":\"https://drive.google.com/file/d/1Hsnyck4T8DHTQav1TgpeUp_WwxbH8Lx2/view?usp=sharing\",\"value\":50},{\"name\":\"13\",\"description\":\"PostGIS: Bases de datos espaciales\",\"group\":\"GIS\",\"id\":13,\"link\":\"https://drive.google.com/file/d/14wdZwogjO-DmD8Jlnkgld7gRwQKFPW4O/view?usp=sharing\",\"value\":120},{\"name\":\"19\",\"description\":\"QGIS Y GRASS – Nivel Avanzado\",\"group\":\"GIS\",\"id\":19,\"link\":\"https://drive.google.com/file/d/1aqPzP-OtCG3jBqYS6K4zOg6xgc2dOGjF/view?usp=sharing\",\"value\":30}]},{\"name\":\"B&G\",\"children\":[{\"name\":\"9\",\"description\":\"Técnico especialista de laboratorio Agroalimentario (Intensivo)\",\"group\":\"B&G\",\"id\":9,\"link\":\"https://drive.google.com/file/d/1OnLp_t1nWR_dYFsKxLn8TZ38Xf4qi3FQ/view?usp=sharing\",\"value\":50}]}]},\"options\":{\"size\":\"value\",\"color_min\":\"hsl(171, 60%, 66%)\",\"color_max\":\"hsl(231, 75%, 11%)\"}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n\n```{.r .cell-code}\n# Save widget as HTML\n# htmlwidgets::saveWidget(circle_certificates, \"circle.html\", selfcontained = TRUE)\n```\n:::\n\n\n\n\nFalta la tabla\n\nThe circular map shows that most courses fall into ENV, GIS, and LNG. In terms of numbers, the LNG area is unbalanced compared to GIS and ENV, since one large circle for a C1 English course (240h) takes up the same space as three smaller GIS courses. A limitation of the circle tree map is that it doesn’t always reflect meaning well, because a GIS course could also relate to ENV, for example when using biodiversity data.\n\n   ",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\n<script src=\"../../site_libs/d3-3.5.6/./d3.min.js\"></script>\n<link href=\"../../site_libs/circlepackeR-0.1/./style.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/circlepackeR-binding-0.0.0.9000/circlepackeR.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}